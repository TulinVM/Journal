{% extends 'home.html' %} 
{% block title %} Мое АСУ {% endblock title %} 
{% block content %}
{% load static %}
<main class="main">
  <!-- <div class="result-wrapper"> -->
    <div class="create-form-wrapper">
    <h1>Информация о наличии и состояние замечаний по АСУ ТП</h1>
      <div class="tabs">
        
          {% if journals %}
          <main class="main">
            <div class="result-wrapper">
             
          
              <!-- Форма фильтра -->
              <form method="get" action="">
    <label for="name_asu">Фильтр по АСУ:</label>
    <select name="name_asu" id="name_asu">
        <option value="">Все</option>
        {% for asu in name_asu_choices %}
            <option value="{{ asu }}" {% if asu == selected_asu %}selected{% endif %}>
                {{ asu }}
            </option>
        {% endfor %}
    </select>
    <!-- Форма фильтра -->
              <form method="get" action="">
    <label for="name_uso">Фильтр по УСО:</label>
    <select name="name_uso" id="name_uso">
        <option value="">Все</option>
        {% for uso in name_uso_choices %}
        
            <option value="{{ uso }}" {% if uso == selected_uso %}selected{% endif %}>
                {{ uso }}
            </option>
        {% endfor %}
    </select>
    <!-- Форма фильтра -->
              <form method="get" action="">
    <label for="name_mkc">Фильтр по МКС:</label>
    <select name="name_mkc" id="name_mkc">
        <option value="">Все</option>
        {% for asu in name_mkc_choices %}
            <option value="{{ asu }}" {% if asu == selected_asu %}selected{% endif %}>
                {{ asu }}
            </option>
        {% endfor %}
    </select>
    <button type="submit" class="sign-button sign-button-large">Фильтровать</button>
</form>
        
       {% if messages %}
  {% for message in messages %}
    <p>{{ message }}</p>
  {% endfor %}
{% endif %} 

        <div class="adaptive-table-wrapper">
          <table class="adaptive-table">
            <thead>
              <tr>
                <th>Дата неисправности</th>
                <th>Наименование АСУ ТП</th>
                <th>№ шкафа</th>
                <th>Тип модуля УСО</th>
                <th>№ модуля УСО</th>
                <th>№ канала УСО</th>
                <th>Тип модуля МКС</th>
                <th>№ модуля МКС</th>
                <th>№ канала МКС</th>
                <th>Назначение канала</th>
                <th>Неисправность</th>
                <th>Автор записи</th>
                <th>Мероприятия</th>
                <th>Дата мероприятия</th>
                <th>Автор мероприятий</th>
                <th>Изменить</th>
              </tr>
            </thead>
          <tbody>
           {% for journal in journals %}
            <tr>
              <td>
                <div class="summary-button">
                  <a href="{% url 'journal_detail' journal.id %}" class="back-href">{{ journal.date_def }}</a>
                  <img src="{% static 'img/eye.svg' %}" alt="Просмотреть" width="16" height="16" class="mg-lft">
                </div>
              </td>
                <td>{{ journal.name_asu }}</td>
                <td>{{ journal.number_cabinet }}</td>                      
                <td>{{ journal.module_type }}</td>
                <td>{{ journal.number_module }}</td>
                <td>{{ journal.number_cannel }}</td>
                <td>{{ journal.module_type_mkc }}</td>
                <td>{{ journal.number_module_mkc }}</td>             
                <td>{{ journal.number_cannel_mkc }}</td>
                <td>{{ journal.channel_purpose }}</td>
                <td>{{ journal.fault }}</td>
                <td>{{ journal.author_def }}</td>
                <td>{{ journal.events }}</td>
                <td>{{ journal.date_events }}</td>
                <td>{{ journal.author_events }}</td>
                                                            
                  {% csrf_token %}                                                  
                <td>
                  <a href="{% url 'journal_detail' journal.pk %}">Просмотр</a>
                  <a href="{% url 'journal_update' journal.pk %}">Редактировать</a>
                  <a href="{% url 'journal_update_two' journal.pk %}">Устранение</a>
                  <a href="{% url 'journal_delete' journal.pk %}">Удалить</a>
                </td>                     
            </tr>
             {% endfor %}
          </tbody>
        </table>
        </div>
          {% else %}
        <div class="result-wrapper">
          <span class="info-if-doesnt-exists">У вас нет дефектов</span>
          {% endif %}
      <div class="create-form-wrapper">
            <form action="{% url 'journal_create' %}">
              <button class="sign-button active-tab" class="sign-button">
               Добавить
              </button>                         
            </form>
          </div>
         </div>
</main>
{% endblock content %}
